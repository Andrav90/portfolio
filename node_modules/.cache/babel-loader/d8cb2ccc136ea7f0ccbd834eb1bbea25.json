{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"Layer\", {\n  enumerable: true,\n  get: function get() {\n    return _Layer[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"AppearLayer\", {\n  enumerable: true,\n  get: function get() {\n    return _AppearLayer[\"default\"];\n  }\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _context = _interopRequireDefault(require(\"./Utils/context\"));\n\nvar _Layer = _interopRequireDefault(require(\"./Components/Layer\"));\n\nvar _AppearLayer = _interopRequireDefault(require(\"./Components/AppearLayer\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n\n  if (obj != null) {\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n        if (desc && (desc.get || desc.set)) {\n          Object.defineProperty(newObj, key, desc);\n        } else {\n          newObj[key] = obj[key];\n        }\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar Parallax = /*#__PURE__*/function (_Component) {\n  _inherits(Parallax, _Component);\n\n  function Parallax(props) {\n    var _this;\n\n    _classCallCheck(this, Parallax);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Parallax).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"addLayer\", function (layer) {\n      _this.layers.push(layer);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"removeLayer\", function (layer) {\n      _this.layers = _this.layers.filter(function (ly) {\n        return ly !== layer;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addAppearLayer\", function (layer) {\n      _this.appearLayers.push(layer);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"removeAppearLayer\", function (layer) {\n      _this.appearLayers = _this.appearLayers(function (ly) {\n        return ly !== layer;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getContext\", function () {\n      return {\n        addLayer: _this.addLayer,\n        removeLayer: _this.removeLayer,\n        addAppearLayer: _this.addAppearLayer,\n        removeAppearLayer: _this.removeAppearLayer\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleScroll\", function () {\n      window.requestAnimationFrame(_this.check);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"check\", function () {\n      _this.checkParallaxItems();\n\n      _this.checkAppearItems();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isOnScreen\", function (layer) {\n      var position = layer.ref.current.getBoundingClientRect();\n      return position.top < window.innerHeight && position.bottom >= 0;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkAppearItems\", function () {\n      _this.appearLayers.forEach(function (layer) {\n        if (_this.isOnScreen(layer)) {\n          _this.appear(layer);\n        } else {//handle disappear\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkParallaxItems\", function () {\n      _this.layers.forEach(function (layer) {\n        if (_this.isOnScreen(layer)) {\n          _this.draw(layer);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"appear\", function (layer) {\n      layer.ref.current.style['animation-duration'] = layer.settings.duration;\n\n      if (layer.settings.loop) {\n        layer.ref.current.style['animation-iteration-count'] = layer.settings.loop;\n      }\n\n      layer.ref.current.classList.add(layer.settings[\"in\"]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"draw\", function (layer) {\n      var item = layer.ref.current;\n      var position = item.getBoundingClientRect();\n      var settings = layer.settings || {\n        type: 'backgroundY',\n        speed: 0.3\n      };\n      var speed = settings.speed;\n      var newValue = -Math.floor(speed * position.top);\n      var min = settings.min || (speed < 0 ? -_this.offset : newValue);\n      var max = settings.max || (speed > 0 ? _this.offset : newValue);\n\n      if (newValue < min) {\n        newValue = min;\n      } else if (newValue > max) {\n        newValue = max;\n      }\n\n      var updatedValues = {};\n\n      if (Array.isArray(settings.type)) {\n        settings.type.forEach(function (t) {\n          var _this$getChangedValue = _this.getChangedValue(t, newValue),\n              key = _this$getChangedValue.key,\n              value = _this$getChangedValue.value;\n\n          if (!updatedValues[key]) {\n            updatedValues[key] = [];\n          }\n\n          updatedValues[key].push(value);\n        });\n      } else {\n        var _this$getChangedValue2 = _this.getChangedValue(settings.type, newValue),\n            key = _this$getChangedValue2.key,\n            value = _this$getChangedValue2.value;\n\n        updatedValues[key] = [value];\n      } // eslint-disable-next-line\n\n\n      for (var _key in updatedValues) {\n        item.style[_key] = updatedValues[_key].join(' ');\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getChangedValue\", function (type, value) {\n      switch (type) {\n        case 'translateY':\n          return {\n            key: 'transform',\n            value: \"translateY(\".concat(value, \"px)\")\n          };\n\n        case 'translateX':\n          return {\n            key: 'transform',\n            value: \"translateX(\".concat(value, \"px)\")\n          };\n        // case 'scale':\n        //   const scale = value >= 0 ? Math.abs(value / 100) : Math.abs(100 / value);\n        //   return {\n        //     key: 'transform',\n        //     value: `scale(${scale})`\n        //   }\n\n        case 'rotate':\n          return {\n            key: 'transform',\n            value: \"rotate(\".concat(value, \"deg)\")\n          };\n\n        case 'backgroundPositionX':\n          return {\n            key: 'backgroundPosition',\n            value: \"\".concat(value, \"px center\")\n          };\n\n        default:\n          return {\n            key: 'backgroundPosition',\n            value: \"center \".concat(value, \"px\")\n          };\n      }\n    });\n\n    _this.layers = [];\n    _this.appearLayers = [];\n    _this.offset = props.offset || 100;\n    return _this;\n  }\n\n  _createClass(Parallax, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setup();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('scroll', this.handleScroll);\n    }\n  }, {\n    key: \"setup\",\n    value: function setup() {\n      window.addEventListener('scroll', this.handleScroll);\n      window.dispatchEvent(new Event('scroll'));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react[\"default\"].createElement(_context[\"default\"].Provider, {\n        value: this.getContext()\n      }, this.props.children);\n    }\n  }]);\n\n  return Parallax;\n}(_react.Component);\n\nexports[\"default\"] = Parallax;","map":{"version":3,"sources":["../src/index.js"],"names":["Parallax","Component","props","ly","addLayer","removeLayer","addAppearLayer","removeAppearLayer","window","position","layer","item","settings","type","speed","newValue","Math","min","max","updatedValues","Array","key","value"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Context from './Utils/context';\nimport Layer from './Components/Layer';\nimport AppearLayer from './Components/AppearLayer';\n\nexport {\n  Layer,\n  AppearLayer\n}\n\nexport default class Parallax extends Component {\n  constructor(props) {\n    super(props);\n\n    this.layers = [];\n    this.appearLayers = [];\n    this.offset = props.offset || 100;\n  }\n\n  addLayer = (layer) => {\n    this.layers.push(layer);\n  }\n\n  removeLayer = (layer) => {\n    this.layers = this.layers.filter(ly => ly !== layer);\n  }\n\n  addAppearLayer = (layer) => {\n    this.appearLayers.push(layer);\n  }\n\n  removeAppearLayer = (layer) => {\n    this.appearLayers = this.appearLayers(ly => ly !== layer);\n  }\n\n  getContext = () => {\n    return {\n      addLayer: this.addLayer,\n      removeLayer: this.removeLayer,\n      addAppearLayer: this.addAppearLayer,\n      removeAppearLayer: this.removeAppearLayer\n    }\n  }\n\n  componentDidMount() {\n    this.setup();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.handleScroll);\n  }\n\n  setup() {\n    window.addEventListener('scroll', this.handleScroll);\n    window.dispatchEvent(new Event('scroll'));\n  }\n\n  handleScroll = () => {\n    window.requestAnimationFrame(this.check)\n  }\n\n  check = () => {\n    this.checkParallaxItems();\n    this.checkAppearItems();\n  }\n\n  isOnScreen = (layer) => {\n    const position = layer.ref.current.getBoundingClientRect();\n    return position.top < window.innerHeight && position.bottom >= 0;\n  }\n\n  checkAppearItems = () => {\n    this.appearLayers.forEach(layer => {\n      if (this.isOnScreen(layer)) {\n        this.appear(layer);\n      } else {\n        //handle disappear\n      }\n    });\n  }\n\n  checkParallaxItems = () => {\n    this.layers.forEach(layer => {\n      if (this.isOnScreen(layer)) {\n        this.draw(layer);\n      }\n    });\n  }\n\n  appear = (layer) => {\n    layer.ref.current.style['animation-duration'] = layer.settings.duration;\n    if (layer.settings.loop) {\n      layer.ref.current.style['animation-iteration-count'] = layer.settings.loop;\n    }\n\n    layer.ref.current.classList.add(layer.settings.in);\n  }\n\n  draw = (layer) => {\n    const item = layer.ref.current;\n    const position = item.getBoundingClientRect();\n    const settings = layer.settings || { type: 'backgroundY', speed: 0.3 };\n\n    const speed = settings.speed;\n    let newValue = -Math.floor(speed * position.top);\n\n    const min = settings.min || (speed < 0 ? -this.offset : newValue);\n    const max = settings.max || (speed > 0 ? this.offset : newValue);\n\n    if (newValue < min) {\n      newValue = min;\n    } else if (newValue > max) {\n      newValue = max;\n    }\n\n    const updatedValues = {};\n    if (Array.isArray(settings.type)) {\n      settings.type.forEach(t => {\n        const { key, value } = this.getChangedValue(t, newValue);\n        if (!updatedValues[key]) {\n          updatedValues[key] = [];\n        }\n        updatedValues[key].push(value);\n      })\n    } else {\n      const { key, value } = this.getChangedValue(settings.type, newValue);\n      updatedValues[key] = [value];\n    }\n\n    // eslint-disable-next-line\n    for (let key in updatedValues) {\n      item.style[key] = updatedValues[key].join(' ');\n    }\n  }\n\n  getChangedValue = (type, value) => {\n    switch (type) {\n      case 'translateY':\n        return {\n          key: 'transform',\n          value: `translateY(${value}px)`\n        };\n\n      case 'translateX':\n        return {\n          key: 'transform',\n          value: `translateX(${value}px)`\n        }\n\n      // case 'scale':\n      //   const scale = value >= 0 ? Math.abs(value / 100) : Math.abs(100 / value);\n      //   return {\n      //     key: 'transform',\n      //     value: `scale(${scale})`\n      //   }\n\n      case 'rotate':\n        return {\n          key: 'transform',\n          value: `rotate(${value}deg)`\n        }\n\n      case 'backgroundPositionX':\n        return {\n          key: 'backgroundPosition',\n          value: `${value}px center`\n        };\n\n      default:\n        return {\n          key: 'backgroundPosition',\n          value: `center ${value}px`\n        };\n    }\n  }\n\n  render() {\n    return (\n      <Context.Provider value={this.getContext()}>\n        {this.props.children}\n      </Context.Provider>\n    )\n  }\n}"]},"metadata":{},"sourceType":"script"}